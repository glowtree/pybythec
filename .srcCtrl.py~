
import os
import sys
import subprocess

if len(sys.argv) < 2:
  print('pull or push required')
  sys.exit(1)

arg1 = sys.argv[1]
if arg1 == 'push':

  if len(sys.argv) < 3:
    print('message required')
    sys.exit(1)
  
  message = sys.argv[2]
  
  versionFile = open('.version', 'r')
  version = versionFile.readline()
  versionFile.close()
  message = version + ' ' + message
  
  subprocess.call(['git', 'add', '-A'])
  subprocess.call(['git', 'commit', '-a', '-m', message])
  subprocess.call(['git', 'push'])
  message = os.path.split(os.getcwd())[1] + ' ' + message
  
  print('\nnow shared\n')
  
  os.chdir(os.getenv('SHARED'))
  subprocess.call(['python', '.srcCtrl.py', 'push', message])  

elif arg1 == 'pull':
  subprocess.call(['git', 'pull'])
  
  print('\nnow shared\n')
  
  os.chdir(os.getenv('SHARED'))
  subprocess.call(['python', '.srcCtrl.py', 'pull']) 
  
else:
  print('pull or push required')

